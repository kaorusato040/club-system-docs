# 機能要件定義書

## 1. 本資料の目的
本資料は、部活動向け業務支援システムにおいて  
**実装対象とする機能要件を明確化し、設計および実装の指針とすること**を目的とする。

本資料は、システム概要資料に基づき、  
「何を実装するか」「何を実装しないか」を明確に定義する。

本資料はフェーズ1（MVP）を対象とする。

---

## 2. システム概要（機能観点）
本システムは、部活動における欠席連絡や試合結果報告を、  
口頭やチャットによる「連絡」ではなく、  
**申請 → 承認 → 証跡** として管理する業務支援システムである。

顧問の確認負担を軽減するとともに、  
判断および責任の所在を明確にすることを目的とする。

---

## 3. 対象ユーザー・ロール

| ロール | 概要 |
|---|---|
| 生徒 | 申請・報告の作成、結果確認、練習スケジュール閲覧 |
| 監督・コーチ（顧問） | 申請・報告の承認、練習スケジュール管理 |
| 管理者 | 部活・メンバー管理、監査ログ閲覧（承認業務には関与しない） |

---

## 4. 提供機能一覧

- A. 欠席系 申請・承認管理（コア機能）
- B. 試合結果報告 申請・承認管理
- C. 練習スケジュール共有
- D. 通知機能
- E. 監査ログ機能

---

# 5. 機能要件詳細

---

# A. 欠席系 申請・承認管理

## A-1. 機能概要
部活動への **欠席／遅刻／早退／不参加** を、  
生徒が申請し、監督・コーチが承認する仕組みを提供する。

申請・承認の履歴は **証跡として保存** され、後から確認可能とする。

---

## A-2. 対象申請種別
- 欠席
- 遅刻
- 早退
- 不参加

---

## A-3. 基本フロー
1. 生徒が申請を作成（下書き）
2. 生徒が申請を提出
3. 監督・コーチが以下を実施
   - 承認
   - 差し戻し
   - 却下
4. 処理結果を申請者が確認

---

## A-4. 入力項目

| 項目 | 必須 | 備考 |
|---|---|---|
| 対象日 | ○ | |
| 申請種別 | ○ | 欠席／遅刻／早退／不参加 |
| 理由 | ○ | テキスト入力 |

---

## A-5. 状態管理
申請は以下の状態を持つ。
- DRAFT（下書き）
- SUBMITTED（提出済み）
- RETURNED（差し戻し）
- APPROVED（承認）
- REJECTED（却下）
- CANCELLED（取消）

---

## A-6. 操作ルール

- 生徒は `DRAFT` / `RETURNED` 状態のみ編集可能
- `SUBMITTED` 状態は取消のみ可能
- 承認・差し戻し・却下は監督・コーチのみ可能
- `APPROVED` / `REJECTED` 状態は閲覧のみ

---

## A-7. 一覧・検索機能

申請一覧には以下のフィルタを設ける。

- ステータス
- 対象期間（From〜To）
- 申請種別
- 更新日時降順（デフォルト）

---

## A-8. 証跡管理

以下の情報を証跡として保存する。

- 操作種別（提出／承認／差し戻し／却下／取消）
- 操作者
- 操作日時
- コメント（差し戻し理由 等）

---

# B. 試合結果報告 申請・承認管理

## B-1. 機能概要
試合結果を報告として申請し、  
監督・コーチの承認後に **部の公式記録として確定** する仕組みを提供する。

---

## B-2. 入力項目

| 項目 | 必須 | 備考 |
|---|---|---|
| 試合日 | ○ | |
| 対戦相手 | ○ | |
| スコア | ○ | 文字列 |
| 勝敗 | ○ | 勝／負／分 |
| コメント | 任意 | |

---

## B-3. 状態管理
欠席系と同一の状態定義を使用する。

---

## B-4. 業務ルール

- 承認前は参考情報（非公式）
- 承認後のみ公式記録
- 修正が必要な場合は再申請とする

---

# C. 練習スケジュール共有

## C-1. 機能概要
監督・コーチが練習予定を登録し、生徒が閲覧できる。

承認フローは設けない。

---

## C-2. 操作権限

| ロール | 操作 |
|---|---|
| 生徒 | 閲覧のみ |
| 監督・コーチ | 登録／編集／削除 |
| 管理者 | 管理（最小） |

---

# D. 通知機能

## D-1. 通知対象

- 申請提出（コーチ向け）
- 承認／差し戻し／却下（生徒向け）

## D-2. 仕様

- 未読／既読管理
- 通知クリックで対象詳細へ遷移

---

# E. 監査ログ機能

以下の操作を監査ログとして保存する。

- 申請提出
- 承認
- 差し戻し
- 却下
- 取消
- スケジュール登録／編集／削除

保存項目：
- 操作種別
- 操作者
- 操作日時
- 対象ID

---

# 6. 共通仕様

## 6-1. 認証・認可

- ロールベースアクセス制御
- 部活動単位でデータ分離

---

## 6-2. スコープ外（フェーズ1対象外）

- メール通知
- 集計レポート機能
- 年度管理機能
- 外部連携

---

# 7. 完了定義（フェーズ1）

以下が満たされることをもってフェーズ1完了とする。

- 生徒→申請→承認→履歴確認が一連で動作する
- 試合結果が承認後に公式扱いとなる
- 通知が表示される
- 監査ログが保存される
- ロールによるアクセス制御が機能する
