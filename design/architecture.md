# アーキテクチャ設計

## 1. 目的
本資料は、部活動向け業務支援システムの **全体構成（アーキテクチャ）** を定義し、  
以降の画面設計・API設計・DB設計・インフラ設計の前提を揃えることを目的とする。

本資料はフェーズ1（MVP）を対象とする。

---

## 2. システム概要（対象範囲）

本システムは以下のMVP機能を提供する。

- 欠席系 申請・承認管理（欠席／遅刻／早退／不参加）
- 試合結果報告 申請・承認管理（承認後に公式記録として確定）
- 練習スケジュール共有（監督・コーチのみ管理、生徒は閲覧）
- 通知機能（アプリ内通知）
- 監査ログ保存

---

## 3. リポジトリ構成

本システムは以下のリポジトリで構成する。

- `club-system-frontend`：フロントエンド（UI）
- `club-system-backend`：バックエンド（API／業務ロジック）
- `club-system-docs`：設計ドキュメント

---

## 4. 採用技術
| 層 | 技術 |
|---|---|
| Frontend | Next.js |
| Backend | Spring Boot |
| セキュリティ | Spring Security（JWT認証・RBAC） |
| Database | PostgreSQL |
| DBマイグレーション | Flyway（DDL管理・バージョン管理） |
| API | REST（JSON） |
| ビルドツール | Gradle |
| CI/CD | GitHub Actions |

---

## 5. 全体アーキテクチャ

### 5.1 構成要素と責務

### ■ Frontend

- 画面表示（ロール別UI制御）
- 入力フォーム管理
- 基本的な入力バリデーション（必須・形式チェック）
- Backend APIの呼び出し
- 認証トークンの保持（JWT）

※ 業務ロジックは保持しない

---

### ■ Backend

- 業務ロジック（申請・承認・状態遷移制御）
- 認証・認可（ロール／部活動単位制御）
- トランザクション管理
- DBアクセス
- 監査ログ記録
- 通知生成
- REST API提供

※ 状態遷移の最終判定はBackendで実施する

---

### ■ Database（PostgreSQL）

- ユーザー情報
- 部活動情報
- 欠席申請データ
- 試合結果データ
- 練習スケジュール
- 通知データ
- 監査ログ（原則UPDATE不可／履歴保持）

---

## 6. Backend内部構成（レイヤードアーキテクチャ）

```text
Controller層
   ↓
Service層（業務ロジック）
   ↓
Repository層（DBアクセス）
   ↓
Database
```
